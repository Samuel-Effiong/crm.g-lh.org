{% extends 'project_management/index.html' %}
{% load static %}
{% load extra_tags %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'custom/to_do/to_do.css' %}">
    <link rel="stylesheet" href="{% static 'custom/autocomplete/autocomplete.css' %}">
{% endblock extra_css %}

{% block content %}
      <div class="container-fluid">
         <div class="row">
            <div class="col-lg-12">
               <div class="card car-transparent">
                  <div class="card-body p-0">
                     <div class="d-flex flex-column justify-content-center align-items-center profile-image position-relative text-center rounded" style="background-image: url({% static 'assets/images/dashboard/Top.webp' %}); background-size: cover; height: 250px">
{#                        <img src="{% static 'assets/images/dashboard/Top.webp' %}" class="img-fluid rounded w-100" alt="profile-image">#}
                         {% if mode is None %}
                             <h1 class="text-white"><b>DIAKONATE</b></h1>

                             {% if user.is_superuser or user|has_project_management_permission:"Core Leader" %}
                                 <p class="m-2">
                                     <button type="button" class="btn btn-primary py-2 px-4" data-target="#add_roles_modal" data-toggle="modal">Add Diakonate</button>
                                 </p>
                             {% endif %}

                         {% elif mode == 'Diakonate' %}
                             <h1 class="text-white">DIAKONATE: <b>{{ diaconate.name }}</b></h1>

                             {% if user.is_superuser or user|has_project_management_permission:"Core Leader" or user|has_project_management_permission:"Diakonate Head" %}
                                 <p class="m-2">
                                     <button type="button" class="btn btn-primary py-2 px-4" data-target="#add_roles_modal" data-toggle="modal">Add Department</button>
                                 </p>
                             {% endif %}
                         {% elif mode == 'Department' %}
                             <h1 class="text-white">DEPARTMENT: <b>{{ department.department_name }}</b></h1>
                             <div class="mt-3">
                                 <button type="button" class="btn btn-primary mr-2 py-2 px-4" data-target="#add_roles_modal" data-toggle="modal">Add Unit</button>
                                 <button type="button" class="btn text-white btn-outline-primary py-2 px-4" data-target="#add_member" data-toggle="modal">Add Member</button>
                             </div>
                         {% elif mode == 'Unit' %}
                             <h1 class="text-white">UNIT: <b>{{ unit.name }}</b></h1>
                             <div class="mt-3">
                                 <button type="button" class="btn btn-primary mr-2 py-2 px-4" data-target="#add_roles_modal" data-toggle="modal">Add SubUnit</button>
                                 <button type="button" class="btn text-white btn-outline-primary py-2 px-4" data-target="#add_member" data-toggle="modal">Add Member</button>
                             </div>
                         {% endif %}
                     </div>
                  </div>
               </div>
            </div>
         </div>
         {% if mode is None %}
              <div class="row">
                  {% for office in diaconates %}
                      <div class="col-lg-4 col-md-6 col-sm-6 mb-4">
                          <div class="card border-primary">
                              <div class="card-body" style="background: linear-gradient(135deg,hsl(230 45% 25%), hsl(265 33% 45%)); color: white; height: 500px">
                                  <h4 class="card-title text-white">
                                      <a href="{% url "project_management:project-settings-diakonate" office.name %}">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-building2 h-5 w-5" data-lov-id="src/pages/Settings.tsx:182:28" data-lov-name="Building2" data-component-path="src/pages/Settings.tsx" data-component-line="182" data-component-file="Settings.tsx" data-component-name="Building2" data-component-content="%7B%22className%22%3A%22h-5%20w-5%22%7D"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg>
                                          {{ office.name }}
                                      </a>
                                  </h4>
                                  <p class="card-text"><small>Leader: {{ office.head }}</small></p>

                                  <div class="d-flex justify-content-center mb-3">
                                      <div class="p-2 mr-2 text-center" style="background-color: hsl(265 33% 45%); border-radius: 10px; width: 100px" >
                                          <h4 class="text-white">{{ office.get_number_of_departments }}</h4>
                                          <p class="mb-0"><small>Departments</small></p>
                                      </div>
                                      <div class="px-1 py-2 text-center" style="background-color: hsl(265 33% 45%); border-radius: 10px; width: 100px">
                                          <h4 class="text-white">{{ office.get_number_of_members_in_diaconate }}</h4>
                                          <p class="mb-0"><small>Members</small></p>
                                      </div>
                                  </div>

                                  <p><b>Departments</b></p>

                                  <div style="overflow-y: auto; height: 250px" class=" py-2">
                                      {% for department in office.departments.all %}
                                          <div class="d-flex justify-content-between">
                                              <p class="h5">
                                                  {% if user|has_project_management_permission:"Department Head" %}
                                                      {% if department in user_leader_in_dept %}
                                                          <a class="text-white" href="{% url "project_management:project-settings-diakonate-department" office.name department.department_name %}">{{ department.department_name }}</a>
                                                      {% else %}
                                                          {{ department.department_name }}
                                                      {% endif %}
                                                  {% else %}
                                                      <a class="text-white" href="{% url "project_management:project-settings-diakonate-department" office.name department.department_name %}">{{ department.department_name }}</a>
                                                  {% endif %}
                                            </p>
                                            <p>{{ department.get_no_of_members }}</p>
                                          </div>
                                      {% endfor %}
                                  </div>
                              </div>
                          </div>
                      </div>

                 {% endfor %}
             </div>
        {% elif mode == 'Diakonate' %} {# project/settings/diakonate #}

             <div class="card-body p-0">
                <div class="row">
                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Total Departments</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ diaconate.departments.count }}</h3>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Total Members</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ diaconate.get_number_of_members_in_diaconate }}</h3>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Total Projects</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ diaconate.get_number_of_projects_in_diaconate }}</h3>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

             <div class="row">
                  {% for dept in diaconate.departments.all %}
                      <div class="col-lg-4 col-md-6 col-sm-6 mb-4">
                          <div class="card border-light">
                              <div class="card-body">
                                  <h4 class="card-title">
                                      <a href="{% url "project_management:project-settings-diakonate-department" diaconate.name dept.department_name %}">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-building2 h-5 w-5" data-lov-id="src/pages/Settings.tsx:182:28" data-lov-name="Building2" data-component-path="src/pages/Settings.tsx" data-component-line="182" data-component-file="Settings.tsx" data-component-name="Building2" data-component-content="%7B%22className%22%3A%22h-5%20w-5%22%7D"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg>
                                          {{ dept.department_name }}
                                      </a>
                                  </h4>
                                  <p class="card-text"><small>Leader: {{ dept.leader.member_name.get_full_name }}</small></p>

                                  <div class="d-flex justify-content-center mb-3">
                                      <div class="p-2 mr-2 text-center bg-light-gray" style="border-radius: 10px; width: 100px" >
                                          <h4 class="">{{ dept.get_no_of_members }}</h4>
                                          <p class="mb-0"><small>Members</small></p>
                                      </div>
                                      <div class="px-1 py-2 text-center bg-danger-light" style="background-color: hsl(265 33% 45%); border-radius: 10px; width: 100px">
                                          <h4 class="">{{ dept.departmentproject_set.count }}</h4>
                                          <p class="mb-0"><small>Projects</small></p>
                                      </div>
                                      <div class="p-2 ml-2 text-center bg-light-gray" style="border-radius: 10px; width: 100px" >
                                          <h4 class="">{{ dept.get_no_of_units }}</h4>
                                          <p class="mb-0"><small>Units</small></p>
                                      </div>
                                  </div>

                                  <div class="d-flex flex-wrap gap-1 pl-2 justify-content-center" style="">

                                      <a class="btn btn-outline-dark mt-2 mr-lg-2 col-lg-7" href="{% url "project_management:project-settings-diakonate-department" diaconate.name dept.department_name %}">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-pen h-3 w-3 mr-1" data-lov-id="src/pages/Settings.tsx:296:30" data-lov-name="Edit" data-component-path="src/pages/Settings.tsx" data-component-line="296" data-component-file="Settings.tsx" data-component-name="Edit" data-component-content="%7B%22className%22%3A%22h-3%20w-3%20mr-1%22%7D"><path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"></path></svg>
                                          Edit
                                      </a>

                                      <a class="col-lg-3 btn btn-outline-dark mt-2" href="{% url "project_management:project-settings-diakonate-department" diaconate.name dept.department_name %}">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2 h-3 w-3" data-lov-id="src/pages/Settings.tsx:300:30" data-lov-name="Trash2" data-component-path="src/pages/Settings.tsx" data-component-line="300" data-component-file="Settings.tsx" data-component-name="Trash2" data-component-content="%7B%22className%22%3A%22h-3%20w-3%22%7D"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17"></line></svg>
                                      </a>
                                  </div>
                              </div>
                          </div>
                      </div>
                  {% empty %}
                      Love God

                 {% endfor %}
             </div>

        {% elif mode == 'Department' %}  {# project/settings/diakonate/settings #}


             <div class="card-body p-0">
                <div class="row">
                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Total Units</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ department.unit_set.count }}</h3>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Total Members</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ department.member_names.count }}</h3>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Total Project</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ department.departmentproject_set.count }}</h3>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Total Tasks</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ department.get_no_of_targets }}</h3>
                            </div>
                        </div>
                    </div>

                </div>
             </div>

             <div class="row">
                  {% for unit in department.unit_set.all %}
                      <div class="col-lg-4 col-md-6 col-sm-6 mb-4">
                          <div class="card border-light">
                              <div class="card-body">
                                  <h4 class="card-title">
                                      <a href="{% url "project_management:project-settings-diakonate-department-unit" diaconate.name department.department_name unit.id %}">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-building2 h-5 w-5" data-lov-id="src/pages/Settings.tsx:182:28" data-lov-name="Building2" data-component-path="src/pages/Settings.tsx" data-component-line="182" data-component-file="Settings.tsx" data-component-name="Building2" data-component-content="%7B%22className%22%3A%22h-5%20w-5%22%7D"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg>
                                          {{ unit.name }}
                                      </a>
                                  </h4>
                                  <p class="card-text"><small>Leader: {{ unit.unit_leader.member_name.get_full_name }}</small></p>

                                  <div class="d-flex justify-content-center mb-3">
                                      <div class="p-2 mr-2 text-center bg-light-gray" style="border-radius: 10px; width: 100px" >
                                          <h4 class="">{{ unit.get_number_of_unit_members }}</h4>
                                          <p class="mb-0"><small>Members</small></p>
                                      </div>
{#                                      <div class="p-2 ml-2 text-center bg-light-gray" style="border-radius: 10px; width: 100px" >#}
{#                                          <h4 class="">{{ dept.get_no_of_units }}</h4>#}
{#                                          <p class="mb-0"><small>Units</small></p>#}
{#                                      </div>#}
                                  </div>

                                  <div class="d-flex flex-wrap gap-1 pl-2 justify-content-center" style="">

                                      <a class="btn btn-outline-dark mt-2 mr-lg-2 col-lg-7" href="{% url "project_management:project-settings-diakonate-department" diaconate.name department.department_name %}">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-pen h-3 w-3 mr-1" data-lov-id="src/pages/Settings.tsx:296:30" data-lov-name="Edit" data-component-path="src/pages/Settings.tsx" data-component-line="296" data-component-file="Settings.tsx" data-component-name="Edit" data-component-content="%7B%22className%22%3A%22h-3%20w-3%20mr-1%22%7D"><path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"></path></svg>
                                          Edit
                                      </a>

                                      <a class="col-lg-3 btn btn-outline-dark mt-2" href="{% url "project_management:project-settings-diakonate-department" diaconate.name department.department_name %}">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2 h-3 w-3" data-lov-id="src/pages/Settings.tsx:300:30" data-lov-name="Trash2" data-component-path="src/pages/Settings.tsx" data-component-line="300" data-component-file="Settings.tsx" data-component-name="Trash2" data-component-content="%7B%22className%22%3A%22h-3%20w-3%22%7D"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17"></line></svg>
                                      </a>
                                  </div>
                              </div>
                          </div>
                      </div>
                  {% empty %}
                      <div class="card col-12 text-center">
                         <div class="card-body mb-3">
                             <p>
                                 <svg width="98px" height="98px" viewBox="0 0 14 14" role="img" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill="#ffa000" d="M10.67276443 3.58608316H6.12087531L4.98290303 2.44811088h-2.8449307c-.62588475 0-1.13797228.51208753-1.13797228 1.13797228v6.82783368c0 .62588475.51208753 1.13797228 1.13797228 1.13797228h8.81928517c.48363822 0 .85347921-.369841.85347921-.85347921V4.72405544c0-.62588475-.51208753-1.13797228-1.13797228-1.13797228z"></path><path fill="#ffca28" d="M11.86763532 5.29304158H4.21477174c-.54053683 0-1.02417505.3982903-1.10952297.93882713l-.96727644 5.32002041h9.01843032c.54053683 0 1.02417505-.3982903 1.10952297-.93882713L12.9771583 6.630159c.14224653-.68278337-.3982903-1.33711743-1.10952298-1.33711743z"></path></g></svg>
                             </p>
                            <h4 class="card-title">No Unit in this Department</h4>
                         </div>
                      </div>

                 {% endfor %}
             </div>

             <div class="row">
                <div class="col-lg-6">
                  <div class="card border-light">
                      <div class="card-body">
                          <h4 class="mb-3">Members</h4>
                          <table class="table table-striped table-hover">
                                <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Name</th>
                                    <th scope="col">Units</th>
                                    <th scope="col">No of Project</th>
                                    <th scope="col">Performance Score</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for member in department.member_names.all %}
                                    <tr>
                                        <th scope="row">{{ forloop.counter }}</th>
                                        <td>{{ member.member_name.get_full_name }}</td>
                                        <td>{% for unit in member.member_units_set.all %}{{ unit.name }}{% if not forloop.last %},{% endif %} {% empty %} - {% endfor %}</td>
                                        <td>{{ member.departmentproject_set.count }}</td>
                                        <td>{{ member.get_performance_score }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                      </div>
                  </div>
                </div>

                 <div class="col-lg-6">
                      <div class="card border-light">
                          <div class="card-body">
                              <h4 class="mb-3">Projects by Department</h4>
                              <table class="table table-striped table-hover">
                                    <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Project Name</th>
                                        <th scope="col">% Completion</th>
                                        <th scope="col">No of Tasks</th>
                                        <th scope="col">Member Assignment Type</th>
                                        <th scope="col">Assigned to</th>
                                        <th scope="col">Priority</th>
                                        <th scope="col">Status</th>

                                    </tr>
                                    </thead>
                                    <tbody>

                                    {% for project in department.departmentproject_set.all %}
                                        <tr>
                                            <th scope="row">{{ forloop.counter }}</th>
                                            <td>{{ project.project_name }}</td>
                                            <td>{{ project.get_complete_percentage }}</td>
                                            <td>{{ project.get_no_of_target }}</td>
                                            <td>{{ project.assignment_type }}</td>
                                            <td>
                                                {% if project.assigned_unit %}
                                                    {{ project.assigned_unit.name }}
                                                {% else %}
                                                    {# Display first few individual members, then ... if many #}
                                                    {% with members_list=project.get_all_members %}
                                                        {% for member in members_list|slice:":3" %}
                                                            {{ member.member_name.get_full_name|default:member.member_name.username }}{% if not forloop.last %}, {% endif %}
                                                        {% empty %}
                                                            -
                                                        {% endfor %}
                                                        {% if member_list.count > 3 %}
                                                            ... ({{ members_list.count|sub:3 }}
                                                        {% endif %}
                                                    {% endwith %}
                                                {% endif %}
                                            </td>
                                            <td>{{ project.project_priority }}</td>
                                            <td>{{ project.status }}</td>
                                        </tr>
                                    {% empty %}
                                        <td colspan="8"><h5>No current project</h5></td>
                                    {% endfor %}
                                    </tbody>
                                </table>
                          </div>
                      </div>
                    </div>
                 </div>

        {% elif mode == 'Unit' %}

             <div class="card-body p-0">
                <div class="row">
                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Unit Members</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ unit.members.count }}</h3>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Sub Units</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>Coming Soon...</h3>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="top-block d-flex align-items-center justify-content-between">
                                    <p class="card-text"><small>Projects by Unit</small></p>
                                    <span class="badge badge-warning">Anual</span>
                                </div>
                                <h3>{{ unit.projects_assigned_to_this_unit.count }}</h3>
                            </div>
                        </div>
                    </div>
                </div>
             </div>

             <ul class="nav nav-tabs" id="myTab-two" role="tablist">
                <li class="nav-item">
                   <a class="nav-link active" id="members-tab-two" data-toggle="tab" href="#members-two" role="tab" aria-controls="members" aria-selected="true">Members ({{ unit.members.count }})</a>
                </li>

                <li class="nav-item">
                   <a class="nav-link" id="insights-tab-two" data-toggle="tab" href="#insights-two" role="tab" aria-controls="insights" aria-selected="false">Insights</a>
                </li>
             </ul>


             <div class="tab-content" id="myTabContent-1">
                <div class="tab-pane fade show active" id="members-two" role="tabpanel" aria-labelledby="members-tab-two">
                   <div class="card-body p-0">
                        <div class="row">
                            <div class="col-lg-12 mt-2 mb-3">
                                <h3>Unit Members ({{ unit.members.count }})</h3>
                            </div>
                            <div class="col-lg-8">

                                {% for member in unit.members.all %}
                                    <div class="card card-block card-stretch">
                                        <div class="card-body">
                                            <div class="top-block d-flex align-items-center justify-content-between">
                                                <h3>{{ member.member_name.get_full_name }}</h3>
                                                <span class="badge badge-warning">{{ member.get_performance_score }}</span>
                                            </div>

                                            <div>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail h-3 w-3 mr-1" data-lov-id="src/pages/Unit.tsx:294:34" data-lov-name="Mail" data-component-path="src/pages/Unit.tsx" data-component-line="294" data-component-file="Unit.tsx" data-component-name="Mail" data-component-content="%7B%22className%22%3A%22h-3%20w-3%20mr-1%22%7D"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
                                                <span>{{ member.member_name.email }}</span>
                                            </div>

                                            <div>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar h-3 w-3 mr-1" data-lov-id="src/pages/Unit.tsx:298:34" data-lov-name="Calendar" data-component-path="src/pages/Unit.tsx" data-component-line="298" data-component-file="Unit.tsx" data-component-name="Calendar" data-component-content="%7B%22className%22%3A%22h-3%20w-3%20mr-1%22%7D"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg>
                                                <span>Joined {{ member.date_joined|date:"D d M Y" }}</span>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}

                                <div class="card border-light">
                                  <div class="card-body">
                                      <h4 class="mb-3">Projects by Unit</h4>
                                      <table class="table table-striped table-hover">
                                            <thead>
                                            <tr>
                                                <th scope="col">#</th>
                                                <th scope="col">Project Name</th>
                                                <th scope="col">% Completion</th>
                                                <th scope="col">No of Target</th>
                                                <th scope="col">Priority</th>
                                                <th scope="col">Status</th>

                                            </tr>
                                            </thead>
                                            <tbody>

                                            {% for project in unit.projects_assigned_to_this_unit.all %}
                                                <tr>
                                                    <th scope="row">{{ forloop.counter }}</th>
                                                    <td>{{ project.project_name }}</td>
                                                    <td>{{ project.get_complete_percentage }}</td>
                                                    <td>{{ project.get_no_of_target }}</td>
                                                    <td>{{ project.project_priority }}</td>
                                                    <td>{{ project.status }}</td>
                                                </tr>
                                            {% empty %}
                                                <td colspan="6"><h5>No current project</h5></td>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                  </div>
                                </div>

                            </div>

                            <div class="col-lg-4">
                                <div class="card card-block card-stretch card-height">
                                    <div class="card-body">
                                        <div class="top-block d-flex align-items-center justify-content-between">
                                            <p class="card-text"><small>Sub Units</small></p>
                                            <span class="badge badge-warning">Anual</span>
                                        </div>
                                        <h3>Coming Soon...</h3>
                                    </div>
                                </div>
                            </div>

                        </div>
                   </div>
                </div>

                <div class="tab-pane fade" id="insights-two" role="tabpanel" aria-labelledby="insights-tab-two">
                   <div class="card col-12 text-center">
                                     <div class="card-body mb-3">
                                         <p>
                                             <svg width="98px" height="98px" viewBox="0 0 14 14" role="img" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill="#ffa000" d="M10.67276443 3.58608316H6.12087531L4.98290303 2.44811088h-2.8449307c-.62588475 0-1.13797228.51208753-1.13797228 1.13797228v6.82783368c0 .62588475.51208753 1.13797228 1.13797228 1.13797228h8.81928517c.48363822 0 .85347921-.369841.85347921-.85347921V4.72405544c0-.62588475-.51208753-1.13797228-1.13797228-1.13797228z"></path><path fill="#ffca28" d="M11.86763532 5.29304158H4.21477174c-.54053683 0-1.02417505.3982903-1.10952297.93882713l-.96727644 5.32002041h9.01843032c.54053683 0 1.02417505-.3982903 1.10952297-.93882713L12.9771583 6.630159c.14224653-.68278337-.3982903-1.33711743-1.10952298-1.33711743z"></path></g></svg>
                                         </p>
                                        <h4 class="card-title">Coming Soon</h4>
                                     </div>
                                </div>
                </div>
             </div>



        {% endif %}
      </div>
{% endblock content %}
    <!-- Wrapper End-->

{% block modal %}
    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="add-category">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_category_title">Add Category</h3>
                </div>
                <div class="modal-body">
                    <form action="{% url 'project_management:project-settings' %}?settings=category" method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="category_name" class="h5">Category Name</label>
                                    <input type="text" class="form-control" name="category_name" id="category_name" placeholder="Enter Category name" required>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="category_objective" class="h5">Objective</label>
                                    <textarea class="form-control" name="category_objective" id="category_objective" cols="20" rows="10"></textarea>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-primary mr-3">Save</button>
                                    <div class="btn btn-primary" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="add-unit">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_unit_title">Add Unit</h3>
                </div>
                <div class="modal-body">
                    <form action="{% url 'project_management:project-settings' %}?settings=unit" method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="unit_name" class="h5">Unit Name</label>
                                    <input type="text" class="form-control" name="unit_name" id="unit_name" placeholder="Enter Unit name" required>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="unit_objective" class="h5">Objective</label>
                                    <textarea class="form-control" name="unit_objective" id="unit_objective" cols="20" rows="10"></textarea>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label for="unit_leader">leader</label>
                                    <select name="unit_leader" id="unit_leader" class="form-control form-select-lg mb-3">
                                        {% for member in department_members %}
                                            <option value="{{ member.pk }}">{{ member.member_name}}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label for="unit_members">Unit Member <span style="color:red">(can select multiple)</span></label>
                                    <select name="unit_members" id="unit_members" class="form-control form-select-lg" multiple>
                                        {% for member in department_members %}
                                            <option value="{{ member.pk }}">{{ member.member_name}}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            
                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-primary mr-3">Save</button>
                                    <div class="btn btn-primary" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="add-member">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_member_title">Add Member</h3>
                </div>
                <div class="modal-body">
                    <form action="{% url 'project_management:project-settings' %}?settings=member" method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-lg-12">
                                {% include 'custom_html/autocomplete.html' with variable='' %}
                            </div>

                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-primary mr-3">Save</button>
                                    <div class="btn btn-primary" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="remove-member">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_remove_member_title">Confirm Removal</h3>
                </div>
                <div class="modal-body">
                    <form action="{% url 'project_management:project-settings' %}?settings=remove_member" method="post">
                        {% csrf_token %}
                        <div class="row">

                            <div class="col-lg-12 mb-3" style="display: none">
                                <input type="text" id="removed_member" name="removed_member">
                            </div>

                            <div class="col-lg-12 mb-3">
                                <h6><i>
                                    Are you sure you want to remove
                                    <span id="member_name" class="text-danger font-size-20"></span>
                                    from {{ department }}?. <span class="text-danger">It cannot be restored.</span>
                                </i></h6>
                            </div>

                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-outline-danger mr-3">Remove</button>
                                    <div class="btn btn-success" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="remove-category">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_remove_member_title">Confirm Removal</h3>
                </div>
                <div class="modal-body">
                    <form action="{% url 'project_management:project-settings' %}?settings=remove_category" method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-lg-12 mb-3" style="display: none">
                                <input type="text" id="removed_category" name="removed_category">
                            </div>

                            <div class="col-lg-12 mb-3">
                                <h6><i>
                                    Are you sure you want to remove
                                    <span id="removed_category_name" class="text-danger font-size-20"></span>
                                    from {{ department }} Category?. <span class="text-danger">It cannot be restored.</span>
                                </i></h6>
                            </div>

                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-outline-danger mr-3">Remove</button>
                                    <div class="btn btn-success" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="experience-score">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_remove_member_title">Evaluation Score</h3>
                </div>
                <div class="modal-body">
                    <form action="{% url 'project_management:project-settings' %}?settings=experience_score" method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-lg-12 mb-3" style="display: none">
                                <input type="text" id="experience_id" name="experience_id">
                            </div>

                            <div class="form-group col-12">
                               <label for="experience_score">Experience Score</label>
                               <input type="number" max="100" min="0" class="form-control" name="experience_score" id="experience_score">
                            </div>

                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-primary mr-3">Update</button>
                                    <div class="btn btn-danger" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="remove-unit">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_remove_member_title">Confirm Removal</h3>
                </div>
                <div class="modal-body">
                    <form action="{% url 'project_management:project-settings' %}?settings=remove_unit" method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-lg-12 mb-3" style="display: none">
                                <input type="text" id="removed_unit" name="removed_unit">
                            </div>

                            <div class="col-lg-12 mb-3">
                                <h6><i>
                                    Are you sure you want to remove
                                    <span id="removed_unit_name" class="text-danger font-size-20"></span>
                                    from {{ department }} Unit?. <span class="text-danger">It cannot be restored.</span>
                                </i></h6>
                            </div>

                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-outline-danger mr-3">Remove</button>
                                    <div class="btn btn-success" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="display_unit_member">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="display_unit_member_title">Unit Members</h3>
                </div>
                <div class="modal-body" id="unit_member_space">
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th scope="col">Name</th>
                        </tr>
                        </thead>
                        <tbody>
                            {% for members in unit_members %}
                                <tr>
                                    <td></td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer" style="display: block;">
                    <form
                        hx-post="{% url 'project_management:project-settings' %}?settings=add_unit_member"
                        hx-trigger="submit"
                        hx-target="#unit_member_space"
                        hx-swap="innerHTML"
                        hx-indicator="#springBouceLoader"
                    >
                        {% csrf_token %}
                        <div style="display: none;">
                            <input type="text" name="unit_to_add_member" id="unit_to_add_member">
                        </div>

                        {% if department_members %}
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <button class="btn btn-primary" type="submit">Add</button>
                                </div>
                                <select name="add_member_to_unit" class="custom-select">
                                {% for member in department_members %}
                                    <option value="{{ member.pk }}">{{ member.member_name.get_full_name }}</option>
                                {% endfor %}
                                </select>
                            </div>
                        {% else %}
                            <div class="alert alert-danger" role="alert">
                                <div class="iq-alert-text">
                                    <b class="alert-link">No member</b> available in this department
                                </div>
                            </div>
                        {% endif %}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="display_unit_information">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="display_unit_information_title">Unit</h3>
                </div>
                <div class="modal-body" id="unit_information_space">
                    <form id="update_unit_form"
                        hx-post="{% url 'project_management:project-settings' %}?settings=update_unit_information"
                        hx-trigger="submit"
                        hx-target="" {# will be set by javascript #}
                        hx-swap="innerHTML"
                        hx-indicator="#springBouceLoader"
                    >
                        {% csrf_token %}
                        <div class="row" id="alert_parent">
                            <div class="col-lg-12" style="display: none;">
                                <input type="text" name="update_unit_pk" id="update_unit_pk">
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="display_unit_name" class="h5">Name:</label>
                                    <input type="text" name="display_unit_name" id="display_unit_name" class="form-control">
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="display_unit_objective" class="h5">Objective:</label>
                                    <textarea name="display_unit_objective" id="display_unit_objective" class="form-control" cols="30" rows="10"></textarea>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="display_unit_leader" class="h5">Leader:</label>
                                    <select name="display_unit_leader" id="display_unit_leader" class=" custom-control custom-select">
                                        
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-center mt-2">
                                    <button type="submit" class="btn btn-primary mr-3">Save</button>
                                    <div class="btn btn-primary" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="add_roles_modal">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_roles_modal_title">
                        {% if mode is None %}
                            Add Diakonate
                        {% elif mode == 'Diakonate' %}
                            Add Department
                        {% elif mode == 'Department' %}
                            Add Unit
                        {% elif mode == 'Unit' %}
                            Add SubUnit
                        {% endif %}
                    </h3>
                </div>
                <div class="modal-body">
                    <form method="post">
                        {% csrf_token %}
                        {% if mode is None %}
{#                            Add Diakonate #}
                            <div class="row">
                                <div class="col-lg-12" style="display: none;">

                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="diakonate-name" class="h5">Name:</label>
                                        <input type="text" name="diakonate-name" id="diakonate-name" class="form-control" placeholder="e.g., ADMINISTRATION" required>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="diakonate-description" class="h5">Description:</label>
                                        <textarea name="diakonate-description" id="diakonate-description" class="form-control" cols="30" rows="10" placeholder="Brief description of the diakonate's purpose" required></textarea>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="diakonate-leader" class="h5">Diakonate Head:</label>
                                        <select name="diakonate-leader" id="diakonate-leader" class=" custom-control custom-select" required>
                                            <option value="" disabled selected>Choose Diakonate head</option>
                                            {% for user in all_users %}
                                                {% if user|has_project_management_permission:"Core Leader" or user.is_superuser %}
                                                    <option value="{{ user.username }}">{{ user.get_full_name }}</option>
                                                {% endif %}
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="diakonate-assistant" class="h5">Diakonate Assistant Head:</label>
                                        <select name="diakonate-assistant" id="diakonate-assistant" class=" custom-control custom-select">
                                            <option value="" disabled selected>Choose Diakonate Assistant</option>
                                            {% for user in all_users %}
                                                <option value="{{ user.username }}">{{ user.get_full_name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>


                                <div class="col-lg-12">
                                    <div class="d-flex flex-wrap align-items-center justify-content-end mt-2">
                                        <button type="submit" class="flex-grow-1 btn btn-primary mr-1">Create Diakonate</button>
                                        <div class="btn btn-outline-light" data-dismiss="modal">Cancel</div>
                                    </div>
                                </div>
                            </div>
                        {% elif mode == 'Diakonate' %}
{#                            Add Department#}
                            <div class="row">
                                <div class="col-lg-12" style="display: none;">
                                    <input type="text" name="form-submission-type" value="{{ mode }}">
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="department-name" class="h5">Name:</label>
                                        <input type="text" name="department-name" id="department-name" class="form-control" placeholder="Enter department name" required>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="department-abridged_name" class="h5">Name (Abbrev):</label>
                                        <input type="text" name="department-abridged-name" id="department-abridged-name" class="form-control" placeholder="Enter department abbreviation e.g., GTT" required>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="department-objective" class="h5">Objectives:</label>
                                        <textarea name="department-objective" id="department-objective" class="form-control" cols="30" rows="10" placeholder="Objective of the department" required></textarea>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="department-head" class="h5">Department Head:</label>
                                        <select name="department-head" id="department-head" class=" custom-control custom-select" required>
                                            <option value="" disabled selected>Choose Department Head:</option>
                                            {% for user in all_users %}
                                                <option value="{{ user.username }}">{{ user.get_full_name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="department-head-assistant" class="h5">Department Head Assistant:</label>
                                        <select name="department-head-assistant" id="department-head-assistant" class=" custom-control custom-select">
                                            <option value="" disabled selected>Choose Department Head Assistant:</option>
                                            {% for user in all_users %}
                                                <option value="{{ user.username }}">{{ user.get_full_name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>


                                <div class="col-lg-12">
                                    <div class="d-flex flex-wrap align-items-center justify-content-end mt-2">
                                        <button type="submit" class="flex-grow-1 btn btn-primary mr-1">Create Department</button>
                                        <div class="btn btn-outline-light" data-dismiss="modal">Cancel</div>
                                    </div>
                                </div>

                            </div>
                        {% elif mode == 'Department' %}
                            <div class="row" id="unit-section">
                                <div class="col-lg-12" style="display: none;">
                                    <input type="text" name="form-submission-type" value="{{ mode }}">
                                    <input type="text" name="form-submission-category" id="form-submission-category" value="unit">
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="unit-name" class="h5">Name:</label>
                                        <input type="text" name="unit-name" id="unit-name" class="form-control" placeholder="Enter unit name" required>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="unit-objective" class="h5">Objectives:</label>
                                        <textarea name="unit-objective" id="unit-objective" class="form-control" cols="30" rows="10" placeholder="Objective of the unit" required></textarea>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="unit-head" class="h5">Unit Head:</label>
                                        <select name="unit-head" id="unit-head" class=" custom-control custom-select">
                                            <option value="" disabled selected>Choose Unit Head:</option>
                                            {% for member in department.member_names.all %}
                                                <option value="{{ member.member_name.id }}">{{ member.member_name.get_full_name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="unit-head-assistant" class="h5">Unit Head Assistant:</label>
                                        <select name="unit-head-assistant" id="department-head-assistant" class=" custom-control custom-select">
                                            <option value="" disabled selected>Choose Unit Head Assistant:</option>
                                            {% for member in department.member_names.all %}
                                                <option value="{{ member.member_name.id }}">{{ member.member_name.get_full_name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>


                                <div class="col-lg-12">
                                    <div class="d-flex flex-wrap align-items-center justify-content-end mt-2">
                                        <button type="submit" class="flex-grow-1 btn btn-primary mr-1">Create Unit</button>
                                        <div class="btn btn-outline-light" data-dismiss="modal">Cancel</div>
                                    </div>
                                </div>

                            </div>

                        {% elif mode == 'Unit' %}
                            <div class="col-lg-12">
                               <div class="card border-secondary">
                                  <div class="card-body text-secondary d-flex justify-content-center align-items-center">
                                     <h4 class="card-title text-secondary">Coming Soon</h4>
                                  </div>
                               </div>
                            </div>
                        {% endif %}

                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bd-example-modal-lg" role="dialog" aria-modal="true" id="add_member">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header d-block text-center pb-3 border-bottom">
                    <h3 class="modal-title" id="add_roles_modal_title">Add Member</h3>
                </div>
                <div class="modal-body">
                    <form method="post">
                        {% csrf_token %}
                        <div class="row" id="member-section">
                            <div class="col-lg-12" style="display: none;">
                                <input type="text" name="form-submission-type" value="{{ mode }}">
                                <input type="text" name="form-submission-category" id="form-submission-category" value="member">
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group mb-3">
                                    <label for="new-member" class="h5">Full Name:</label>
                                    <select name="new-member" id="new-member" class=" custom-control custom-select" required>
                                        <option value="" disabled selected>Add Member:</option>
                                        {% for user in all_users %}
                                            {% if mode == 'Unit' %}
                                                {% if user.username not in unit.get_members_in_this_unit %}
                                                	<option value="{{ user.username }}">{{ user.get_full_name }}</option>
                                                {% endif %}
                                            {% else %}
                                                <option value="{{ user.username }}">{{ user.get_full_name }}</option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            {% if mode != 'Unit' %}
                                <div class="col-lg-12">
                                    <div class="form-group mb-3">
                                        <label for="member-unit" class="h5">Unit (Optional)</label>
                                        <select name="member-unit" id="member-unit" class=" custom-control custom-select">
                                            <option value="" disabled selected>Select Unit:</option>
                                            {% for unit in department.unit_set.all %}
                                                <option value="{{ unit.id }}">{{ unit.name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            {% endif %}






                            <div class="col-lg-12">
                                <div class="d-flex flex-wrap align-items-center justify-content-end mt-2">
                                    <button type="submit" class="flex-grow-1 btn btn-primary mr-1">Add Member</button>
                                    <div class="btn btn-outline-light" data-dismiss="modal">Cancel</div>
                                </div>
                            </div>

                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock modal %}

{% block extra_js %}
    <script src="{% static 'custom/jquery-3.7.1.min.js' %}"></script>
    <script src="{% static 'custom/to_do/to_do.js' %}"></script>
    <script>
        let searchIndex = {{ family_members|jsonify }};
    </script>
    <script src="{% static 'custom/autocomplete/auto_complete.js' %}"></script>

{% endblock extra_js %}

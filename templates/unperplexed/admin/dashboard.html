{% extends "project_management/index.html" %}
{% load static %}
{% load extra_tags %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'unperplexed/css/apexcharts.css' %}">
{% endblock extra_css %}

{% block project_management_nav %}
    <li class="">
        <a href="#unperplexed" class="collapsed" data-toggle="collapse" aria-expanded="false">
            <svg class="svg-icon" width="25" height="25" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
            <span class="ml-4">Unperplexed</span>
            <i class="las la-angle-right iq-arrow-right arrow-active"></i>
            <i class="las la-angle-down iq-arrow-right arrow-hover"></i>
        </a>
        <ul id="unperplexed" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
            <li class="{% if page == 'Unperplexed' %}{% if category == 'Dashboard' %}active{% endif %}{% endif %}">
                <a href="{% url 'unperplexed:dashboard' %}">
                    <i class="las la-minus"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="{% if page == 'Unperplexed' %}{% if category == 'Worker' %}active{% endif %}{% endif %}">
                <a href="{% url 'unperplexed:worker' %}">
                    <i class="las la-minus"></i>
                    <span>Workers</span>
                </a>
            </li>
            <li class="{% if page == 'Unperplexed' %}{% if category == 'Organization' %}active{% endif %}{% endif %}">
                <a href="{% url 'unperplexed:organization' %}">
                    <i class="las la-minus"></i>
                    <span>Organizations</span>
                </a>
            </li>
            <li class="{% if page == 'Unperplexed' %}{% if category == 'Contract' %}active{% endif %}{% endif %}">
                <a href="{% url 'unperplexed:contract' %}">
                    <i class="las la-minus"></i>
                    <span>Contracts</span>
                </a>
            </li>
        </ul>
    </li>
{% endblock project_management_nav %}

{% block content %}
    <div class="container-fluid d-flex justify-content-between align-items-center mb-5">
        <div>
            <h4>Dashboard</h4>
            <p>Overview of Artisans and Contracts</p>
        </div>
        <div>
            <input type="text" name="" id="" placeholder="Search Artisans..." style="border-radius: 5px; padding: 0px 10px; height: 45px; width: 200px">
            <button type="button" class="btn btn-primary mx-2 py-2">View all Artisans</button>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6 col-lg-3">
                <div class="card card-block card-stretch card-height">
                    <div class="card-body">
                        <div class="top-block d-flex align-items-center justify-content-between">
                            <h5>Total Artisan</h5>
                            <span class="badge badge-primary">Monthly</span>
                        </div>
                        <h3><span class="counter" style="visibility: visible;">{{ total_artisans }}</span></h3>
                        <div class="d-flex align-items-center justify-content-between mt-1">
                            <p class="mb-0">+12% from last month</p>
{#                            <span class="text-primary">65%</span>#}
                        </div>
                        <div class="iq-progress-bar bg-primary-light mt-2">
                            <span class="bg-primary iq-progress progress-1" data-percent="65" style="transition: width 2s; width: 65%;"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-3">
                <div class="card card-block card-stretch card-height">
                    <div class="card-body">
                        <div class="top-block d-flex align-items-center justify-content-between">
                            <h5>Total Artisan</h5>
                            <span class="badge badge-primary">Monthly</span>
                        </div>
                        <h3><span class="counter" style="visibility: visible;">{{ total_artisans }}</span></h3>
                        <div class="d-flex align-items-center justify-content-between mt-1">
                            <p class="mb-0">+12% from last month</p>
{#                            <span class="text-primary">65%</span>#}
                        </div>
                        <div class="iq-progress-bar bg-primary-light mt-2">
                            <span class="bg-primary iq-progress progress-1" data-percent="65" style="transition: width 2s; width: 65%;"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-3">
                <div class="card card-block card-stretch card-height">
                    <div class="card-body">
                        <div class="top-block d-flex align-items-center justify-content-between">
                            <h5>Total Artisan</h5>
                            <span class="badge badge-primary">Monthly</span>
                        </div>
                        <h3><span class="counter" style="visibility: visible;">{{ total_artisans }}</span></h3>
                        <div class="d-flex align-items-center justify-content-between mt-1">
                            <p class="mb-0">+12% from last month</p>
{#                            <span class="text-primary">65%</span>#}
                        </div>
                        <div class="iq-progress-bar bg-primary-light mt-2">
                            <span class="bg-primary iq-progress progress-1" data-percent="65" style="transition: width 2s; width: 65%;"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-3">
                <div class="card card-block card-stretch card-height">
                    <div class="card-body">
                        <div class="top-block d-flex align-items-center justify-content-between">
                            <h5>Total Artisan</h5>
                            <span class="badge badge-primary">Monthly</span>
                        </div>
                        <h3><span class="counter" style="visibility: visible;">{{ total_artisans }}</span></h3>
                        <div class="d-flex align-items-center justify-content-between mt-1">
                            <p class="mb-0">+12% from last month</p>
{#                            <span class="text-primary">65%</span>#}
                        </div>
                        <div class="iq-progress-bar bg-primary-light mt-2">
                            <span class="bg-primary iq-progress progress-1" data-percent="65" style="transition: width 2s; width: 65%;"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <div class="row">
            <div class="col-lg-6 col-sm-6 col-md-6">
               <div class="card">
                  <div class="card-body">
                      <h4 class="card-title mb-0">Artisan Availability</h4>
                      <p class="card-text">Current status of all artisan</p>
                      <div id="chart"></div>
                      <a href="#" class="btn btn-primary btn-block">Go somewhere</a>
                  </div>
               </div>
            </div>
            <div class="col-lg-6 col-sm-6 col-md-6">
               <div class="card">
                  <div class="card-body">
                      <h4 class="card-title">Top Skills</h4>
                      <p class="card-text">Most commons skills among artisans</p>
                      <div id="chart2"></div>
                      <a href="#" class="btn btn-primary btn-block">Go somewhere</a>
                  </div>
               </div>
            </div>
            <div class="col-lg-6 col-sm-6 col-md-6">
               <div class="card">
                  <div class="card-body">
                      <h4 class="card-title">Recent Contracts</h4>
                      <p class="card-text">Latest contracts created</p>
                      <div></div>
                      <a href="#" class="btn btn-primary btn-block">Go somewhere</a>
                  </div>
               </div>
            </div>
            <div class="col-lg-6 col-sm-6 col-md-6">
               <div class="card">
                  <div class="card-body">
                      <h4 class="card-title">Top Rated Artisans</h4>
                      <p class="card-text">Highest rated artisans on the platform</p>
                      <div></div>
                      <a href="#" class="btn btn-primary btn-block">Go somewhere</a>
                  </div>
               </div>
            </div>

            <div class="col-lg-12 col-sm-12 col-md-12">
               <div class="card">
                  <div class="card-body">
                      <h4 class="card-title">Contract Schedules</h4>
                      <p class="card-text">Upcoming contract deadlines and milestones</p>
                      <div>
                          <div class="project-item mb-5">
                              <div class="d-flex justify-content-between align-items-center" style="margin-bottom: -20px">
                                  <p><b>Custom Dining Table Set</b></p>
                                  <p>End: <span></span></p>
                              </div>
                              <div class="d-flex justify-content-between" style="margin-bottom: -10px">
                                  <p>Progress</p>
                                  <p class="percentage">60%</p>
                              </div>
                              <div class="progress mb-1">
                                  <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%"></div>
                              </div>
                              <p>Artisan: Jennifer Cooper</p>
                          </div>
                           <div class="project-item mb-5">
                              <div class="d-flex justify-content-between align-items-center" style="margin-bottom: -20px">
                                  <p><b>Custom Dining Table Set</b></p>
                                  <p>End: <span></span></p>
                              </div>
                              <div class="d-flex justify-content-between" style="margin-bottom: -10px">
                                  <p>Progress</p>
                                  <p class="percentage">60%</p>
                              </div>
                              <div class="progress mb-1">
                                  <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%"></div>
                              </div>
                              <p>Artisan: Jennifer Cooper</p>
                          </div>
                           <div class="project-item">
                              <div class="d-flex justify-content-between align-items-center" style="margin-bottom: -20px">
                                  <p><b>Custom Dining Table Set</b></p>
                                  <p>End: <span></span></p>
                              </div>
                              <div class="d-flex justify-content-between" style="margin-bottom: -10px">
                                  <p>Progress</p>
                                  <p class="percentage">60%</p>
                              </div>
                              <div class="progress mb-1">
                                  <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%"></div>
                              </div>
                              <p>Artisan: Jennifer Cooper</p>
                          </div>
                      </div>
                      <a href="#" class="btn btn-primary btn-block">Go somewhere</a>
                  </div>
               </div>
            </div>
         </div>
    </div>
    
{% endblock content %}


{% block extra_js %}
    <script src="{% static 'unperplexed/js/apexcharts.min.js' %}"></script>
    <script>
        let options = {
            series: [50, 33, 17], // Assuming "Unavailable" is 17% (100 - 50 - 33)
            chart: {
                width: 380,
                type: 'pie',
            },
            labels: ['Available', 'Busy', 'Unavailable'],
            colors: ['#008000', '#FFD700', '#FF0000'], // Green, Gold, Red
            legend: {
                position: 'bottom'
            },
            dataLabels: {
                enabled: true,
                formatter: function (val, opts) {
                    return val + "%"
                },
                style: {
                  fontSize: '14px',
                  fontFamily: undefined,
                  fontWeight: 'bold',
                  colors: ['#fff']
                },
                dropShadow: {
                    enabled: false,
                }
            },
            responsive: [{
                breakpoint: 480,
                options: {
                    chart: {
                        width: 200
                    },
                    legend: {
                        position: 'bottom'
                    }
                }
            }]
        };
    
        let chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();

        let options2 = {
          series: [{
            data: [1, 1, 1] // Assuming all skills have the same count for this example
          }],
          chart: {
            type: 'bar',
            height: 350
          },
          plotOptions: {
            bar: {
              borderRadius: 4,
              horizontal: false,
            }
          },
          dataLabels: {
            enabled: false
          },
          xaxis: {
            categories: ['Carpentry', 'Wood Restoration', 'Metal Fabrication'],
          },
          yaxis: {
            max: 1, // Set the maximum value for the y-axis to 1
            tickAmount: 5, // Set the number of ticks on the y-axis
            labels: {
              formatter: function (value) {
                return value.toFixed(2); // Format y-axis labels to two decimal places
              }
            }
          },
          title: {
            text: 'Top Skills',
            align: 'left'
          },
          subtitle: {
            text: 'Most common skills among artisans',
            align: 'left'
          }
        };

        let chart2 = new ApexCharts(document.querySelector("#chart2"), options2);
        chart2.render();

    </script>

{% endblock extra_js %}